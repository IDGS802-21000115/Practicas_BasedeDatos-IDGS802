{% extends 'layout2.html' %}
    {%from "_macros.html" import input_Form%}
{%block content%}
    <div class="container">
        <div class="row">
            <form name="registro"  id="registro" method="POST" onsubmit="return submitForm()">
                <div class="row control-group">
                    <div class="form-group col-xs-12 float-label-form-group controls">
                        {{input_Form(form.nombre,class="form-control")}}
                    </div>
                </div>
                <div class="row control-group">
                    <div class="form-group col-xs-12 float-label-form-group controls">
                        {{input_Form(form.direccion,class="form-control")}}
                    </div>
                </div>
                <div class="row control-group">
                    <div class="form-group col-xs-12 float-label-form-group controls">
                        {{input_Form(form.telefono,class="form-control")}}
                    </div>
                </div>
                <div class="row control-group">
                    <div class="form-group col-xs-12 float-label-form-group controls">
                        {{input_Form(form.tamaño,class="form-control")}}
                    </div>
                </div>
                
                <label>Ingredientes</label>
            <div>
                {{ form.jamon() }} Jamon
            </div>
            <div>
                {{ form.piña() }} Piña
            </div>
            <div>
                {{ form.champiñones() }} Champiñones
            </div>
                <div class="row control-group">
                    <div class="form-group col-xs-12 float-label-form-group controls">
                        {{input_Form(form.numero,class="form-control")}}
                    </div>
                </div>
                
                
                <input type="hidden" name="csrf_token" value="{{csrf_token()}}"/>
                <input type="hidden" name="accion" id="accion" value="insertar_bd" />

                <input type="submit" id="registrar" name="registrar" value="Registrar"/>
                <button type="button" onclick="cambiarAccion('insertar_archivo')">Insertar en archivo</button>
               
            </form>
            
            <table class="table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>Nombre</th>
                        <th>total</th>
                    </tr>
                </thead>
            <tbody>
                {%for pizza_bd in pizzass_bd%}
                <tr>
                    <td>{{pizza_bd.nombre}}</td>
                    <td>{{pizza_bd.total}}</td>
                    
                </tr>
                {%endfor%}
            </tbody>
        </table>
        <table class="table table-striped table-bordered">
            <thead>
                <tr>
                    <th>Tamaño</th>
                    <th>Ingredientes</th>
                    <th>Número</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% if datos_archivo %}
                    {% for dato in datos_archivo %}
                        <tr>
                            <td>{{ dato['tamaño'] }}</td>
                            <td>
                                {% if dato['ingredientes'] %}
                                    <ul>
                                        {% for ingrediente in dato['ingredientes'].split(',') %}
                                            <li>{{ ingrediente }}</li>
                                        {% endfor %}
                                    </ul>
                                {% else %}
                                    Ningún ingrediente seleccionado
                                {% endif %}
                            </td>
                            <td>{{ dato['numero'] }}</td>
                            <td>{{ dato['subtotal'] }}</td>
                        </tr>
                    {% endfor %}
                {% endif %}
            </tbody>
            
        </table>
        <script>
            function cambiarAccion(accion) {
                document.getElementById('accion').value = accion;
                document.getElementById('registro').submit();
            }
    
            function submitForm() {
                // Aquí puedes agregar lógica adicional antes de enviar el formulario, si es necesario
                return true;
            }
        </script>
        </div>
    </div>
{%endblock%}